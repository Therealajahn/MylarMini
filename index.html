<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mylar Mini</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      body {
        width: 100vw;
        height: 100vh;
        display: grid;
      }

			.plate{
        justify-self: center;
        align-self: center;
        display: grid;
        border-radius: 1vw;
			}
      .back.plate {
        width: 60vw;
        height: 30vw;
        background: black;
        grid-template-rows: 20% 20% 60%;
        grid-template-columns: 1fr;
      }
      .top.plate {
        width: 90%;
        height: 90%;
        background: grey;
        display: grid;
      }
      .mid.plate {
        width: 90%;
        height: 90%;
        background: grey;
        display: grid;
      }
      .main.plate {
        width: 90%;
        height: 90%;
        background: grey;
        display: grid;
      }

      panels-wrapper {
        justify-self: center;
        align-self: center;
        width: 99%;
        height: 99.9%;
        display: grid;
        grid-template-rows: 1fr;
        grid-template-columns: repeat(8, 1fr);
      }
      .panel {
        justify-self: center;
        align-self: center;
        width: 90%;
        height: 95%;
        background: #7d7d7d; 
        border-radius: 0.5vw;
        display: grid;
        grid-template-rows: 1fr;
				border: .25vw solid white; 
      }

			panel-center {
        justify-self: center;
        align-self: center;
        width: 95%;
				height: 48%; 
        border-radius: 0.5vw;
        display: grid;
				border: .15vw solid white; 
			}

			square-button{
        justify-self: center;
        align-self: center;
				width: 3vw;
				height: 3vw;
        border-radius: 0.5vw;
				display:grid; 
			}
			part-of-button{
				width: 1.2vw;
				height: 1.2vw;
			}
			part-of-button.top{
				background:red;
			}
			part-of-button.bottom{
				background:blue;
			}

    </style>
  </head>
  <body>

    <back-plate>
      <top-plate></top-plate>
      <mid-plate></mid-plate>
      <main-plate>
			</main-plate>
    </back-plate>

    <script>
      const backPlate = document.querySelector("back-plate");
      backPlate.setAttribute("class", "back plate");

      const topPlate = document.querySelector("top-plate");
      topPlate.setAttribute("class", "top plate");

      const midPlate = document.querySelector("mid-plate");
      midPlate.setAttribute("class", "mid plate");

      const mainPlate = document.querySelector("main-plate");
      mainPlate.setAttribute("class", "main plate");
      const panelsWrapper = document.createElement("panels-wrapper");
      mainPlate.appendChild(panelsWrapper);

      function repeatElement({ repititions, elementName, typeName, parentName, callback }) {
        for (let i = 0; i < repititions; i++) {
          let currentElement;
					if(typeof typeName === "string"){
						currentElement = document.createElement(`${typeName}-${elementName}-`);
						currentElement.setAttribute("class", `${elementName}`);
						parentName.appendChild(currentElement);
						callback( currentElement );
						continue; 
					}
					if(!typeName[i]){break};
					if(typeof typeName === "object"){
						currentElement = document.createElement(`${typeName[i]}-${elementName}`);
						currentElement.setAttribute("class", `${elementName}`);
						parentName.appendChild(currentElement);
						callback( currentElement );
						continue; 
					}
					if(typeName.length !== repititions){
						throw new Error(
							`Array length doesn't match repititions for ${elementName}: ${i}`)
					}
				}
			}

      repeatElement({
        repititions: 8,
				elementName:"panel",
				typeName:[
					"rhythm",
				],
        parentName: panelsWrapper,
				callback: customizePanel,
      });

			function customizePanel(element){
				console.log('element',element.tagName);
				switch(element.tagName){
					case 'RHYTHM-PANEL':
						createRythmPanel();
					break;
				}
				////////PANEL COMPONENTS//////////////
				function createRythmPanel(){
					//add center
					const panelCenter = document.createElement('panel-center');
					element.appendChild(panelCenter);
					//add button component
					const squareButton = document.createElement('square-button');	
					panelCenter.appendChild(squareButton);
					const partOfButtonTop = document.createElement('part-of-button');
					partOfButtonTop.setAttribute('class','top');
					squareButton.appendChild(partOfButtonTop);
					const partOfButtonBottom = document.createElement('part-of-button');
					partOfButtonBottom.setAttribute('class','bottom');
					squareButton.appendChild(partOfButtonBottom);
				}
			}

    </script>
  </body>
</html>
